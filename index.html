<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pulse ‚Äî The Heartbeat of Your Community</title>
<style>
/* ========== Section 1: CSS Custom Properties ========== */
:root {
  --bg-darkest: #0d0d14;
  --bg-dark: #13131f;
  --bg-primary: #1a1a2e;
  --bg-secondary: #1f1f35;
  --bg-tertiary: #252542;
  --bg-hover: #2a2a4a;
  --bg-active: #32325a;
  --text-primary: #e8e8f0;
  --text-secondary: #a0a0b8;
  --text-muted: #6b6b80;
  --accent-primary: #7c5cff;
  --accent-secondary: #ff6b6b;
  --accent-green: #43b581;
  --accent-yellow: #faa61a;
  --accent-red: #f04747;
  --glass-bg: rgba(255,255,255,0.03);
  --glass-border: rgba(255,255,255,0.06);
  --font-stack: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --transition: 200ms ease;
}

[data-theme="light"] {
  --bg-darkest: #ffffff;
  --bg-dark: #f0f0f5;
  --bg-primary: #e8e8f0;
  --bg-secondary: #f5f5fa;
  --bg-tertiary: #e0e0ea;
  --bg-hover: #d8d8e5;
  --bg-active: #d0d0e0;
  --text-primary: #1a1a2e;
  --text-secondary: #555570;
  --text-muted: #8888a0;
  --glass-bg: rgba(0,0,0,0.03);
  --glass-border: rgba(0,0,0,0.08);
}

[data-theme="oled"] {
  --bg-darkest: #000000;
  --bg-dark: #0a0a0a;
  --bg-primary: #111111;
  --bg-secondary: #161616;
  --bg-tertiary: #1c1c1c;
  --bg-hover: #222222;
  --bg-active: #2a2a2a;
  --text-primary: #e8e8f0;
  --text-secondary: #909098;
  --text-muted: #606068;
  --glass-bg: rgba(255,255,255,0.02);
  --glass-border: rgba(255,255,255,0.04);
}

/* ========== Section 2: Reset & Base ========== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 15px; }
body {
  font-family: var(--font-stack);
  background: var(--bg-darkest);
  color: var(--text-primary);
  line-height: 1.6;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}
a { color: var(--accent-primary); text-decoration: none; }
button { font-family: inherit; cursor: pointer; border: none; background: none; color: inherit; }
input, textarea { font-family: inherit; }
img { max-width: 100%; display: block; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--bg-hover); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--bg-active); }

/* ========== Section 3: Landing Page Styles ========== */
.landing { display: block; }
.app-view { display: none; }
body.in-app .landing { display: none; }
body.in-app .app-view { display: grid; }

/* Navbar */
.navbar {
  position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
  display: flex; align-items: center; justify-content: space-between;
  padding: 16px 48px; height: 72px;
  background: rgba(13,13,20,0.7);
  backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--glass-border);
  transition: background var(--transition);
}
.navbar.scrolled { background: rgba(13,13,20,0.95); }
.nav-logo { display: flex; align-items: center; gap: 10px; }
.nav-logo svg { width: 36px; height: 36px; }
.nav-logo span { font-size: 22px; font-weight: 700; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
.nav-links { display: flex; gap: 32px; list-style: none; }
.nav-links a { color: var(--text-secondary); font-size: 14px; font-weight: 500; transition: color var(--transition); }
.nav-links a:hover { color: var(--text-primary); }
.nav-cta {
  padding: 10px 24px; border-radius: var(--radius-xl);
  background: linear-gradient(135deg, var(--accent-primary), #6a4de0);
  color: #fff; font-weight: 600; font-size: 14px;
  transition: transform var(--transition), box-shadow var(--transition);
}
.nav-cta:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(124,92,255,0.35); }

/* Hero */
.hero {
  min-height: 100vh; display: flex; flex-direction: column;
  align-items: center; justify-content: center; text-align: center;
  padding: 120px 24px 80px; position: relative; overflow: hidden;
}
.hero-bg {
  position: absolute; inset: 0; z-index: 0;
  background: radial-gradient(ellipse 80% 60% at 50% 40%, rgba(124,92,255,0.12) 0%, transparent 70%),
              radial-gradient(ellipse 60% 50% at 20% 80%, rgba(255,107,107,0.08) 0%, transparent 60%),
              radial-gradient(ellipse 60% 50% at 80% 20%, rgba(67,181,129,0.06) 0%, transparent 60%);
}
.hero-pulse-line {
  position: absolute; bottom: 0; left: 0; right: 0; height: 200px;
  z-index: 0; opacity: 0.15;
}
.hero-content { position: relative; z-index: 1; max-width: 800px; }
.hero h1 {
  font-size: clamp(36px, 6vw, 72px); font-weight: 800;
  line-height: 1.1; margin-bottom: 24px;
  background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.hero h1 em {
  font-style: normal;
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.hero p { font-size: 18px; color: var(--text-secondary); max-width: 560px; margin: 0 auto 40px; }
.hero-ctas { display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; }
.btn-primary {
  padding: 14px 32px; border-radius: var(--radius-xl);
  background: linear-gradient(135deg, var(--accent-primary), #6a4de0);
  color: #fff; font-weight: 600; font-size: 16px;
  transition: transform var(--transition), box-shadow var(--transition);
}
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 32px rgba(124,92,255,0.4); }
.btn-secondary {
  padding: 14px 32px; border-radius: var(--radius-xl);
  border: 1px solid var(--glass-border); background: var(--glass-bg);
  color: var(--text-primary); font-weight: 600; font-size: 16px;
  transition: all var(--transition);
}
.btn-secondary:hover { border-color: var(--accent-primary); background: rgba(124,92,255,0.1); }

/* Pain Points */
.section { padding: 100px 48px; max-width: 1200px; margin: 0 auto; }
.section-label {
  font-size: 12px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 2px; color: var(--accent-primary); margin-bottom: 12px;
}
.section-title { font-size: clamp(28px, 4vw, 44px); font-weight: 700; margin-bottom: 16px; }
.section-sub { font-size: 16px; color: var(--text-secondary); max-width: 600px; margin-bottom: 56px; }
.pain-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; }
.pain-card {
  padding: 32px; border-radius: var(--radius-lg);
  background: var(--bg-primary); border: 1px solid var(--glass-border);
  transition: transform var(--transition), border-color var(--transition);
}
.pain-card:hover { transform: translateY(-4px); border-color: var(--accent-primary); }
.pain-card .bad { color: var(--accent-red); font-size: 13px; font-weight: 600; margin-bottom: 4px; display: flex; align-items: center; gap: 6px; }
.pain-card .good { color: var(--accent-green); font-size: 13px; font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 6px; }
.pain-card h3 { font-size: 20px; margin-bottom: 8px; }
.pain-card p { color: var(--text-secondary); font-size: 14px; }

/* Features Grid */
.features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }
.feature-card {
  padding: 32px; border-radius: var(--radius-lg);
  background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
  border: 1px solid var(--glass-border);
  transition: transform var(--transition), border-color var(--transition);
}
.feature-card:hover { transform: translateY(-4px); border-color: var(--accent-primary); }
.feature-icon {
  width: 48px; height: 48px; border-radius: 12px;
  background: rgba(124,92,255,0.15); display: flex; align-items: center;
  justify-content: center; margin-bottom: 16px; font-size: 22px;
}
.feature-card h3 { font-size: 18px; margin-bottom: 8px; }
.feature-card p { color: var(--text-secondary); font-size: 14px; }

/* App Preview */
.app-preview-section { text-align: center; }
.app-preview-container {
  margin-top: 40px; border-radius: var(--radius-lg);
  border: 1px solid var(--glass-border); overflow: hidden;
  box-shadow: 0 32px 80px rgba(0,0,0,0.5);
  background: var(--bg-dark);
  position: relative; padding: 0; max-width: 1100px; margin-left: auto; margin-right: auto;
}
.app-preview-mockup {
  width: 100%; height: 500px; display: grid;
  grid-template-columns: 72px 200px 1fr 180px;
  font-size: 12px; text-align: left;
}
.mock-serverbar { background: var(--bg-dark); padding: 12px 0; display: flex; flex-direction: column; align-items: center; gap: 8px; }
.mock-server {
  width: 42px; height: 42px; border-radius: 50%;
  background: var(--bg-tertiary); display: flex; align-items: center;
  justify-content: center; font-size: 16px; cursor: default;
}
.mock-sidebar { background: var(--bg-primary); padding: 16px 12px; }
.mock-sidebar h4 { font-size: 13px; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid var(--glass-border); }
.mock-channel { padding: 6px 8px; border-radius: 4px; color: var(--text-secondary); font-size: 12px; margin-bottom: 2px; }
.mock-channel.active { background: var(--bg-active); color: var(--text-primary); }
.mock-chat { background: var(--bg-secondary); padding: 16px; display: flex; flex-direction: column; }
.mock-msg { display: flex; gap: 10px; margin-bottom: 12px; }
.mock-avatar { width: 32px; height: 32px; border-radius: 50%; background: var(--accent-primary); flex-shrink: 0; }
.mock-msg-content span { font-weight: 600; font-size: 12px; }
.mock-msg-content p { font-size: 12px; color: var(--text-secondary); margin-top: 2px; }
.mock-members { background: var(--bg-primary); padding: 16px 12px; }
.mock-members h4 { font-size: 10px; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); margin-bottom: 8px; }
.mock-member { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; font-size: 12px; }
.mock-member-av { width: 24px; height: 24px; border-radius: 50%; background: var(--bg-tertiary); }
.preview-callout {
  position: absolute; padding: 8px 14px; border-radius: 8px;
  background: var(--accent-primary); color: #fff; font-size: 12px;
  font-weight: 600; white-space: nowrap; pointer-events: none;
  box-shadow: 0 4px 16px rgba(124,92,255,0.4);
}
.preview-callout::after {
  content: ''; position: absolute; width: 8px; height: 8px;
  background: var(--accent-primary); transform: rotate(45deg);
}
.callout-1 { top: 30px; left: 20px; }
.callout-1::after { right: -4px; top: 50%; margin-top: -4px; }
.callout-2 { top: 30px; right: 20px; }
.callout-2::after { left: -4px; top: 50%; margin-top: -4px; }
.callout-3 { bottom: 30px; left: 50%; transform: translateX(-50%); }
.callout-3::after { top: -4px; left: 50%; margin-left: -4px; }

/* Pricing */
.pricing-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }
.pricing-card {
  padding: 36px; border-radius: var(--radius-lg);
  background: var(--bg-primary); border: 1px solid var(--glass-border);
  transition: transform var(--transition);
}
.pricing-card.featured {
  border-color: var(--accent-primary);
  background: linear-gradient(135deg, rgba(124,92,255,0.1), var(--bg-primary));
  transform: scale(1.03);
}
.pricing-card:hover { transform: translateY(-4px); }
.pricing-card.featured:hover { transform: scale(1.03) translateY(-4px); }
.pricing-badge {
  display: inline-block; padding: 4px 12px; border-radius: 20px;
  background: var(--accent-primary); color: #fff; font-size: 11px;
  font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px;
}
.pricing-card h3 { font-size: 22px; margin-bottom: 8px; }
.pricing-price { font-size: 40px; font-weight: 800; margin-bottom: 4px; }
.pricing-price span { font-size: 16px; font-weight: 400; color: var(--text-muted); }
.pricing-desc { color: var(--text-secondary); font-size: 14px; margin-bottom: 24px; }
.pricing-features { list-style: none; margin-bottom: 32px; }
.pricing-features li {
  padding: 8px 0; font-size: 14px; color: var(--text-secondary);
  display: flex; align-items: center; gap: 10px;
}
.pricing-features li::before { content: '‚úì'; color: var(--accent-green); font-weight: 700; }
.pricing-btn {
  display: block; width: 100%; padding: 12px; border-radius: var(--radius-md);
  text-align: center; font-weight: 600; font-size: 14px;
  transition: all var(--transition);
}
.pricing-btn.primary { background: var(--accent-primary); color: #fff; }
.pricing-btn.primary:hover { background: #6a4de0; }
.pricing-btn.outline { border: 1px solid var(--glass-border); color: var(--text-primary); }
.pricing-btn.outline:hover { border-color: var(--accent-primary); }

/* Footer */
.footer {
  padding: 60px 48px 32px; border-top: 1px solid var(--glass-border);
  max-width: 1200px; margin: 0 auto;
}
.footer-grid { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 40px; margin-bottom: 40px; }
.footer-brand p { color: var(--text-secondary); font-size: 14px; margin-top: 12px; max-width: 280px; }
.footer-col h4 { font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 16px; color: var(--text-muted); }
.footer-col a { display: block; color: var(--text-secondary); font-size: 14px; padding: 4px 0; transition: color var(--transition); }
.footer-col a:hover { color: var(--text-primary); }
.footer-bottom { text-align: center; padding-top: 24px; border-top: 1px solid var(--glass-border); color: var(--text-muted); font-size: 13px; }

/* ========== Section 4: App Layout ========== */
.app-view {
  height: 100vh; width: 100vw;
  grid-template-columns: 72px 240px 1fr;
  grid-template-rows: 1fr;
  overflow: hidden;
}
.app-view.members-visible { grid-template-columns: 72px 240px 1fr 240px; }

/* ========== Section 5: Server Bar ========== */
.server-bar {
  background: var(--bg-dark); display: flex; flex-direction: column;
  align-items: center; padding: 12px 0; gap: 8px;
  overflow-y: auto; overflow-x: hidden;
}
.server-bar::-webkit-scrollbar { width: 0; }
.server-home {
  width: 48px; height: 48px; border-radius: 16px;
  background: var(--bg-tertiary); display: flex; align-items: center;
  justify-content: center; transition: all var(--transition);
  position: relative; cursor: pointer;
}
.server-home:hover, .server-home.active { background: var(--accent-primary); border-radius: 16px; }
.server-home svg { width: 24px; height: 24px; fill: var(--text-secondary); }
.server-home:hover svg, .server-home.active svg { fill: #fff; }
.server-separator { width: 32px; height: 2px; background: var(--glass-border); border-radius: 1px; margin: 4px 0; }
.server-icon-wrap { position: relative; width: 48px; height: 48px; }
.server-pill {
  position: absolute; left: -4px; top: 50%; width: 4px;
  background: var(--text-primary); border-radius: 0 4px 4px 0;
  transition: all var(--transition); transform: translateY(-50%);
  height: 0; opacity: 0;
}
.server-icon-wrap:hover .server-pill { height: 20px; opacity: 1; }
.server-icon-wrap.active .server-pill { height: 36px; opacity: 1; }
.server-icon-wrap.has-notification .server-pill { height: 8px; opacity: 1; }
.server-icon {
  width: 48px; height: 48px; border-radius: 50%;
  background: var(--bg-tertiary); display: flex; align-items: center;
  justify-content: center; font-size: 18px; font-weight: 600;
  transition: all var(--transition); cursor: pointer;
  overflow: hidden; position: relative;
}
.server-icon:hover, .server-icon-wrap.active .server-icon { border-radius: 16px; background: var(--accent-primary); }
.server-badge {
  position: absolute; bottom: -2px; right: -2px; min-width: 18px;
  height: 18px; padding: 0 5px; border-radius: 9px;
  background: var(--accent-red); color: #fff; font-size: 11px;
  font-weight: 700; display: flex; align-items: center; justify-content: center;
  border: 2px solid var(--bg-dark);
  animation: pulse-badge 2s ease-in-out infinite;
}
.server-add {
  width: 48px; height: 48px; border-radius: 50%;
  background: var(--bg-tertiary); display: flex; align-items: center;
  justify-content: center; font-size: 24px; color: var(--accent-green);
  transition: all var(--transition); cursor: pointer; margin-top: 4px;
}
.server-add:hover { background: var(--accent-green); color: #fff; border-radius: 16px; }

/* ========== Section 6: Channel Sidebar ========== */
.channel-sidebar {
  background: var(--bg-primary); display: flex; flex-direction: column;
  overflow: hidden;
}
.channel-header {
  padding: 16px; height: 48px; display: flex; align-items: center;
  justify-content: space-between; font-weight: 700; font-size: 15px;
  border-bottom: 1px solid var(--glass-border);
  box-shadow: 0 1px 4px rgba(0,0,0,0.2); cursor: pointer;
  transition: background var(--transition);
}
.channel-header:hover { background: var(--bg-hover); }
.channel-header svg { width: 16px; height: 16px; fill: var(--text-secondary); }
.channel-list { flex: 1; overflow-y: auto; padding: 8px 0; }
.channel-category {
  padding: 16px 16px 4px; font-size: 11px; font-weight: 700;
  text-transform: uppercase; letter-spacing: 0.5px;
  color: var(--text-muted); cursor: pointer; display: flex;
  align-items: center; gap: 4px;
  transition: color var(--transition);
}
.channel-category:hover { color: var(--text-secondary); }
.channel-category svg { width: 10px; height: 10px; fill: currentColor; transition: transform var(--transition); }
.channel-category.collapsed svg { transform: rotate(-90deg); }
.channel-item {
  display: flex; align-items: center; gap: 8px;
  padding: 6px 16px; margin: 1px 8px; border-radius: var(--radius-sm);
  color: var(--text-muted); font-size: 14px; font-weight: 500;
  cursor: pointer; transition: all var(--transition);
  min-height: 32px;
}
.channel-item:hover { background: var(--bg-hover); color: var(--text-secondary); }
.channel-item.active { background: var(--bg-active); color: var(--text-primary); }
.channel-item .hash { font-size: 18px; font-weight: 400; opacity: 0.5; }
.channel-item .channel-name { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.channel-item .unread-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--text-primary); }
.voice-users { padding: 2px 0 4px 44px; }
.voice-user {
  display: flex; align-items: center; gap: 6px; padding: 2px 0;
  font-size: 12px; color: var(--text-secondary);
}
.voice-user-av { width: 20px; height: 20px; border-radius: 50%; background: var(--bg-tertiary); }

/* User Panel */
.user-panel {
  padding: 8px; background: var(--bg-dark);
  display: flex; align-items: center; gap: 8px;
  border-top: 1px solid var(--glass-border);
}
.user-panel-avatar {
  width: 32px; height: 32px; border-radius: 50%;
  background: var(--accent-primary); position: relative; flex-shrink: 0;
  cursor: pointer;
}
.user-panel-avatar .status-dot {
  position: absolute; bottom: -1px; right: -1px;
  width: 10px; height: 10px; border-radius: 50%;
  border: 2px solid var(--bg-dark);
}
.status-online { background: var(--accent-green); }
.status-idle { background: var(--accent-yellow); }
.status-dnd { background: var(--accent-red); }
.status-offline { background: var(--text-muted); }
.user-panel-info { flex: 1; min-width: 0; }
.user-panel-name { font-size: 13px; font-weight: 600; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.user-panel-tag { font-size: 11px; color: var(--text-muted); }
.user-panel-actions { display: flex; gap: 4px; }
.user-panel-btn {
  width: 32px; height: 32px; border-radius: var(--radius-sm);
  display: flex; align-items: center; justify-content: center;
  transition: background var(--transition); position: relative;
}
.user-panel-btn:hover { background: var(--bg-hover); }
.user-panel-btn svg { width: 18px; height: 18px; fill: var(--text-secondary); }
.e2e-badge {
  display: flex; align-items: center; gap: 6px; padding: 6px 12px;
  margin: 8px 8px 0; border-radius: var(--radius-sm);
  background: rgba(67,181,129,0.1); color: var(--accent-green);
  font-size: 11px; font-weight: 600;
}

/* ========== Section 7: Chat Area ========== */
.chat-area { display: flex; flex-direction: column; background: var(--bg-secondary); overflow: hidden; }
.chat-header {
  height: 48px; padding: 0 16px; display: flex; align-items: center;
  gap: 12px; border-bottom: 1px solid var(--glass-border);
  box-shadow: 0 1px 4px rgba(0,0,0,0.2); flex-shrink: 0;
}
.chat-header-channel { font-weight: 700; font-size: 15px; display: flex; align-items: center; gap: 6px; }
.chat-header-channel .hash { color: var(--text-muted); font-weight: 400; }
.chat-header-divider { width: 1px; height: 24px; background: var(--glass-border); }
.chat-header-topic { font-size: 13px; color: var(--text-muted); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.chat-header-actions { display: flex; gap: 4px; }
.chat-header-btn {
  width: 32px; height: 32px; border-radius: var(--radius-sm);
  display: flex; align-items: center; justify-content: center;
  transition: background var(--transition); position: relative;
}
.chat-header-btn:hover { background: var(--bg-hover); }
.chat-header-btn svg { width: 20px; height: 20px; fill: var(--text-secondary); }
.chat-header-btn.active svg { fill: var(--text-primary); }

/* Messages */
.chat-messages { flex: 1; overflow-y: auto; padding: 16px 0; }
.message-group { padding: 2px 16px; display: flex; gap: 16px; position: relative; }
.message-group:hover { background: rgba(0,0,0,0.06); }
.message-group.first-in-group { padding-top: 16px; margin-top: 0; }
.message-group.continued { padding-left: 72px; }
.msg-avatar {
  width: 40px; height: 40px; border-radius: 50%;
  flex-shrink: 0; cursor: pointer; display: flex;
  align-items: center; justify-content: center;
  font-weight: 700; font-size: 16px; color: #fff;
}
.msg-body { flex: 1; min-width: 0; }
.msg-header { display: flex; align-items: baseline; gap: 8px; margin-bottom: 2px; }
.msg-username { font-weight: 600; font-size: 15px; cursor: pointer; }
.msg-username:hover { text-decoration: underline; }
.msg-timestamp { font-size: 12px; color: var(--text-muted); }
.msg-text { font-size: 15px; line-height: 1.6; color: var(--text-primary); word-wrap: break-word; }
.msg-text code { background: var(--bg-tertiary); padding: 2px 6px; border-radius: 3px; font-size: 13px; font-family: 'Consolas', 'Monaco', monospace; }
.msg-image { margin-top: 8px; max-width: 400px; border-radius: var(--radius-md); overflow: hidden; background: var(--bg-tertiary); }
.msg-image img { width: 100%; }
.msg-embed {
  margin-top: 8px; padding: 12px 16px; border-radius: var(--radius-md);
  background: var(--bg-tertiary); border-left: 3px solid var(--accent-primary);
  max-width: 520px;
}
.msg-embed-title { font-weight: 600; font-size: 14px; color: var(--accent-primary); margin-bottom: 4px; }
.msg-embed-desc { font-size: 13px; color: var(--text-secondary); }
.msg-reactions { display: flex; gap: 6px; margin-top: 6px; flex-wrap: wrap; }
.msg-reaction {
  display: flex; align-items: center; gap: 4px;
  padding: 2px 8px; border-radius: 6px;
  background: var(--bg-tertiary); border: 1px solid transparent;
  font-size: 13px; cursor: pointer;
  transition: all var(--transition);
}
.msg-reaction:hover { border-color: var(--accent-primary); background: rgba(124,92,255,0.1); }
.msg-reaction.active { border-color: var(--accent-primary); background: rgba(124,92,255,0.15); }
.msg-reaction .count { font-size: 12px; color: var(--text-secondary); }
.msg-thread {
  margin-top: 6px; padding: 4px 8px; border-radius: 4px;
  background: var(--bg-tertiary); font-size: 13px;
  color: var(--accent-primary); cursor: pointer;
  display: inline-flex; align-items: center; gap: 4px;
  transition: background var(--transition);
}
.msg-thread:hover { background: var(--bg-hover); }
.msg-actions {
  position: absolute; top: -16px; right: 16px;
  display: none; gap: 2px; padding: 4px;
  background: var(--bg-tertiary); border-radius: var(--radius-sm);
  border: 1px solid var(--glass-border); box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}
.message-group:hover .msg-actions { display: flex; }
.msg-action-btn {
  width: 28px; height: 28px; border-radius: var(--radius-sm);
  display: flex; align-items: center; justify-content: center;
  transition: background var(--transition); font-size: 16px;
}
.msg-action-btn:hover { background: var(--bg-hover); }
.system-message {
  padding: 4px 16px; font-size: 13px; color: var(--text-muted);
  display: flex; align-items: center; gap: 8px;
}
.system-message svg { width: 16px; height: 16px; fill: var(--text-muted); }
.new-messages-divider {
  display: flex; align-items: center; gap: 8px; padding: 8px 16px;
  margin: 8px 0;
}
.new-messages-divider::before, .new-messages-divider::after {
  content: ''; flex: 1; height: 1px; background: var(--accent-red);
}
.new-messages-divider span { font-size: 11px; font-weight: 700; color: var(--accent-red); text-transform: uppercase; white-space: nowrap; }

/* Typing Indicator */
.typing-indicator {
  padding: 4px 16px; font-size: 13px; color: var(--text-secondary);
  height: 24px; display: flex; align-items: center; gap: 8px;
}
.typing-dots { display: flex; gap: 3px; }
.typing-dots span {
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--text-secondary);
  animation: typing-bounce 1.4s ease-in-out infinite;
}
.typing-dots span:nth-child(2) { animation-delay: 0.2s; }
.typing-dots span:nth-child(3) { animation-delay: 0.4s; }

/* ========== Section 9: Message Input ========== */
.chat-input-area { padding: 0 16px 16px; flex-shrink: 0; }
.chat-input-wrapper {
  display: flex; align-items: flex-end; gap: 0;
  background: var(--bg-tertiary); border-radius: var(--radius-md);
  padding: 4px 4px 4px 12px; position: relative;
}
.input-btn {
  width: 36px; height: 36px; border-radius: var(--radius-sm);
  display: flex; align-items: center; justify-content: center;
  transition: all var(--transition); flex-shrink: 0;
  font-size: 18px; color: var(--text-muted);
}
.input-btn:hover { color: var(--text-secondary); background: var(--bg-hover); }
.chat-input {
  flex: 1; background: none; border: none; outline: none;
  color: var(--text-primary); font-size: 15px; padding: 8px 8px;
  resize: none; max-height: 200px; min-height: 36px; line-height: 1.4;
}
.chat-input::placeholder { color: var(--text-muted); }
.char-count { font-size: 11px; color: var(--text-muted); padding: 0 8px; align-self: flex-end; margin-bottom: 10px; }
.char-count.warn { color: var(--accent-yellow); }
.char-count.over { color: var(--accent-red); }

/* ========== Section 8: Member List ========== */
.member-list {
  background: var(--bg-primary); overflow-y: auto; padding: 12px 8px;
  display: none;
}
.app-view.members-visible .member-list { display: block; }
.member-role-group { margin-bottom: 8px; }
.member-role-header {
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.5px; color: var(--text-muted); padding: 8px 8px 4px;
}
.member-item {
  display: flex; align-items: center; gap: 8px;
  padding: 6px 8px; border-radius: var(--radius-sm);
  cursor: pointer; transition: background var(--transition);
}
.member-item:hover { background: var(--bg-hover); }
.member-avatar {
  width: 32px; height: 32px; border-radius: 50%;
  position: relative; flex-shrink: 0; display: flex;
  align-items: center; justify-content: center;
  font-weight: 700; font-size: 13px; color: #fff;
}
.member-avatar .status-dot {
  position: absolute; bottom: -1px; right: -1px;
  width: 10px; height: 10px; border-radius: 50%;
  border: 2px solid var(--bg-primary);
}
.member-info { flex: 1; min-width: 0; }
.member-name { font-size: 13px; font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.member-activity { font-size: 11px; color: var(--text-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.member-item.offline { opacity: 0.4; }

/* ========== Section 10: Modals & Popups ========== */
.modal-overlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.6);
  display: none; align-items: center; justify-content: center;
  z-index: 2000; backdrop-filter: blur(4px);
}
.modal-overlay.open { display: flex; }
.modal {
  background: var(--bg-primary); border-radius: var(--radius-lg);
  border: 1px solid var(--glass-border); max-width: 600px; width: 90%;
  max-height: 80vh; overflow-y: auto;
  box-shadow: 0 16px 48px rgba(0,0,0,0.4);
  animation: modal-in 200ms ease;
}
.modal-header {
  padding: 20px 24px; display: flex; align-items: center;
  justify-content: space-between; border-bottom: 1px solid var(--glass-border);
}
.modal-header h2 { font-size: 18px; }
.modal-close {
  width: 32px; height: 32px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 20px; color: var(--text-muted);
  transition: all var(--transition);
}
.modal-close:hover { background: var(--bg-hover); color: var(--text-primary); }
.modal-body { padding: 24px; }

/* Profile Card */
.profile-card {
  position: fixed; z-index: 1500; width: 320px;
  background: var(--bg-primary); border-radius: var(--radius-lg);
  border: 1px solid var(--glass-border);
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  overflow: hidden; display: none;
  animation: modal-in 150ms ease;
}
.profile-card.open { display: block; }
.profile-banner { height: 80px; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); }
.profile-avatar-wrap {
  margin: -32px 0 0 16px; position: relative; width: 64px; height: 64px;
}
.profile-avatar {
  width: 64px; height: 64px; border-radius: 50%;
  border: 4px solid var(--bg-primary); display: flex;
  align-items: center; justify-content: center;
  font-size: 24px; font-weight: 700; color: #fff;
}
.profile-info { padding: 8px 16px 16px; }
.profile-name { font-size: 18px; font-weight: 700; }
.profile-tag { font-size: 13px; color: var(--text-muted); }
.profile-bio { font-size: 13px; color: var(--text-secondary); margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--glass-border); }
.profile-roles { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 8px; }
.profile-role {
  padding: 2px 8px; border-radius: 4px; font-size: 11px;
  font-weight: 600; border: 1px solid;
}
.profile-msg-btn {
  margin: 12px 16px 16px; padding: 8px; border-radius: var(--radius-sm);
  background: var(--accent-primary); color: #fff; text-align: center;
  font-weight: 600; font-size: 13px; width: calc(100% - 32px);
  transition: background var(--transition);
}
.profile-msg-btn:hover { background: #6a4de0; }

/* Settings Modal */
.settings-grid { display: grid; gap: 20px; }
.settings-section h3 { font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); margin-bottom: 12px; }
.theme-options { display: flex; gap: 12px; }
.theme-option {
  flex: 1; padding: 16px; border-radius: var(--radius-md);
  border: 2px solid var(--glass-border); cursor: pointer;
  text-align: center; transition: all var(--transition);
}
.theme-option:hover { border-color: var(--accent-primary); }
.theme-option.active { border-color: var(--accent-primary); background: rgba(124,92,255,0.1); }
.theme-swatch { width: 40px; height: 40px; border-radius: 50%; margin: 0 auto 8px; }
.theme-option span { font-size: 13px; font-weight: 600; }
.toggle-row {
  display: flex; align-items: center; justify-content: space-between;
  padding: 8px 0;
}
.toggle-row span { font-size: 14px; }
.toggle-switch {
  width: 44px; height: 24px; border-radius: 12px;
  background: var(--bg-hover); position: relative;
  cursor: pointer; transition: background var(--transition);
}
.toggle-switch.on { background: var(--accent-primary); }
.toggle-switch::after {
  content: ''; position: absolute; top: 3px; left: 3px;
  width: 18px; height: 18px; border-radius: 50%;
  background: #fff; transition: transform var(--transition);
}
.toggle-switch.on::after { transform: translateX(20px); }

/* Search Modal */
.search-modal .modal { max-width: 550px; }
.search-input-wrap {
  display: flex; align-items: center; gap: 8px;
  padding: 12px 16px; background: var(--bg-tertiary);
  border-radius: var(--radius-md); margin-bottom: 16px;
}
.search-input-wrap svg { width: 20px; height: 20px; fill: var(--text-muted); flex-shrink: 0; }
.search-input {
  flex: 1; background: none; border: none; outline: none;
  color: var(--text-primary); font-size: 15px;
}
.search-input::placeholder { color: var(--text-muted); }
.search-filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
.search-chip {
  padding: 4px 12px; border-radius: 20px;
  background: var(--bg-tertiary); font-size: 12px;
  color: var(--text-secondary); cursor: pointer;
  transition: all var(--transition);
}
.search-chip:hover { background: var(--accent-primary); color: #fff; }
.search-results { color: var(--text-muted); font-size: 14px; text-align: center; padding: 24px 0; }

/* Emoji Picker */
.emoji-picker {
  position: absolute; bottom: 100%; right: 8px; margin-bottom: 8px;
  width: 340px; background: var(--bg-primary); border-radius: var(--radius-lg);
  border: 1px solid var(--glass-border);
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  display: none; z-index: 100;
  animation: modal-in 150ms ease;
}
.emoji-picker.open { display: block; }
.emoji-picker-search {
  padding: 12px; border-bottom: 1px solid var(--glass-border);
}
.emoji-picker-search input {
  width: 100%; padding: 8px 12px; border-radius: var(--radius-sm);
  background: var(--bg-tertiary); border: none; outline: none;
  color: var(--text-primary); font-size: 13px;
}
.emoji-picker-search input::placeholder { color: var(--text-muted); }
.emoji-tabs {
  display: flex; padding: 4px 8px; gap: 2px;
  border-bottom: 1px solid var(--glass-border);
}
.emoji-tab {
  padding: 6px 8px; border-radius: var(--radius-sm);
  font-size: 16px; cursor: pointer;
  transition: background var(--transition);
}
.emoji-tab:hover, .emoji-tab.active { background: var(--bg-hover); }
.emoji-grid {
  display: grid; grid-template-columns: repeat(8, 1fr);
  gap: 2px; padding: 8px; max-height: 200px; overflow-y: auto;
}
.emoji-item {
  width: 100%; aspect-ratio: 1; display: flex; align-items: center;
  justify-content: center; font-size: 20px; border-radius: var(--radius-sm);
  cursor: pointer; transition: background var(--transition);
}
.emoji-item:hover { background: var(--bg-hover); transform: scale(1.2); }

/* ========== Section 11: Animations ========== */
@keyframes pulse-badge {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}
@keyframes typing-bounce {
  0%, 60%, 100% { transform: translateY(0); }
  30% { transform: translateY(-4px); }
}
@keyframes modal-in {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}
@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 0 0 rgba(124,92,255,0.4); }
  50% { box-shadow: 0 0 0 8px rgba(124,92,255,0); }
}
@keyframes float-in {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes gradient-shift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
.animate-on-scroll { opacity: 0; transform: translateY(30px); transition: opacity 0.6s ease, transform 0.6s ease; }
.animate-on-scroll.visible { opacity: 1; transform: translateY(0); }

/* ========== Section 12: Responsive ========== */
@media (max-width: 1024px) {
  .app-view { grid-template-columns: 72px 200px 1fr; }
  .app-view.members-visible { grid-template-columns: 72px 200px 1fr; }
  .app-view.members-visible .member-list { display: none; }
  .footer-grid { grid-template-columns: 1fr 1fr; }
}
@media (max-width: 768px) {
  .navbar { padding: 16px 20px; }
  .nav-links { display: none; }
  .section { padding: 60px 20px; }
  .app-preview-mockup { grid-template-columns: 1fr; height: auto; }
  .mock-serverbar, .mock-sidebar, .mock-members { display: none; }
  .footer-grid { grid-template-columns: 1fr; }
  .pricing-grid { grid-template-columns: 1fr; }
  .pain-grid { grid-template-columns: 1fr; }
  .features-grid { grid-template-columns: 1fr; }
}
@media (max-width: 600px) {
  .hero h1 { font-size: 32px; }
  .hero p { font-size: 16px; }
}
</style>
</head>
<body>
<!-- ==================== LANDING PAGE ==================== -->
<div class="landing">

  <!-- Navbar -->
  <nav class="navbar" id="navbar">
    <div class="nav-logo">
      <svg viewBox="0 0 36 36" fill="none">
        <circle cx="18" cy="18" r="16" stroke="url(#logo-grad)" stroke-width="2.5" fill="none"/>
        <path d="M8 18 Q12 10, 16 18 Q18 22, 20 18 Q24 10, 28 18" stroke="url(#logo-grad)" stroke-width="2.5" fill="none" stroke-linecap="round"/>
        <defs><linearGradient id="logo-grad" x1="0" y1="0" x2="36" y2="36"><stop offset="0%" stop-color="#7c5cff"/><stop offset="100%" stop-color="#ff6b6b"/></linearGradient></defs>
      </svg>
      <span>Pulse</span>
    </div>
    <ul class="nav-links">
      <li><a href="#features">Features</a></li>
      <li><a href="#app-preview">App</a></li>
      <li><a href="#pricing">Pricing</a></li>
    </ul>
    <button class="nav-cta" onclick="enterApp()">Open App</button>
  </nav>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-bg"></div>
    <svg class="hero-pulse-line" viewBox="0 0 1440 200" preserveAspectRatio="none">
      <path d="M0,100 Q180,100 360,100 T540,60 Q600,30 660,100 Q690,140 720,100 T900,100 Q1080,100 1260,100 T1440,100" stroke="url(#pulse-line-grad)" stroke-width="2" fill="none" opacity="0.5">
        <animate attributeName="d" dur="3s" repeatCount="indefinite" values="M0,100 Q180,100 360,100 T540,60 Q600,30 660,100 Q690,140 720,100 T900,100 Q1080,100 1260,100 T1440,100;M0,100 Q180,100 360,100 T540,100 Q600,60 660,40 Q690,100 720,140 T900,100 Q1080,100 1260,100 T1440,100;M0,100 Q180,100 360,100 T540,60 Q600,30 660,100 Q690,140 720,100 T900,100 Q1080,100 1260,100 T1440,100"/>
      </path>
      <defs><linearGradient id="pulse-line-grad" x1="0" y1="0" x2="1440" y2="0" gradientUnits="userSpaceOnUse"><stop offset="0%" stop-color="transparent"/><stop offset="30%" stop-color="#7c5cff"/><stop offset="50%" stop-color="#ff6b6b"/><stop offset="70%" stop-color="#7c5cff"/><stop offset="100%" stop-color="transparent"/></linearGradient></defs>
    </svg>
    <div class="hero-content">
      <h1>GreenGru <em>Hub of all of my useful files</em></h1>
      <p>This is the hub of all my downloads and socials.You will be able to find important downloads like unblocked downloads for StrongdogXP, Noahs Tutoring, and many other sites. These files can be ran localy, completely unblocked! </p>
      <div class="hero-ctas">
        <button class="btn-primary" onclick="enterApp()">Try Pulse Free</button>
        <button class="btn-secondary" onclick="document.getElementById('app-preview').scrollIntoView({behavior:'smooth'})">See It In Action</button>
      </div>
    </div>
  </section>

  <!-- Pain Points -->
  <section class="section animate-on-scroll" id="pain-points">
    <div class="section-label">Why Switch?</div>
    <h2 class="section-title">We fixed what they broke.</h2>
    <p class="section-sub">While others chase trends and break interfaces, we focus on what matters: making communication feel effortless.</p>
    <div class="pain-grid">
      <div class="pain-card">
        <div class="bad">‚úï Square icons, cramped layout</div>
        <div class="good">‚úì Circular icons, spacious design</div>
        <h3>Breathable Interface</h3>
        <p>Every element has room to breathe. Bigger icons, proper spacing, and a layout that doesn't give you eye strain after 20 minutes.</p>
      </div>
      <div class="pain-card">
        <div class="bad">‚úï Harsh pure-black contrast</div>
        <div class="good">‚úì Warm, eye-friendly dark theme</div>
        <h3>Designed for Late Nights</h3>
        <p>Our warm color palette is scientifically designed to reduce eye fatigue. Because your community doesn't sleep, but your eyes need comfort.</p>
      </div>
      <div class="pain-card">
        <div class="bad">‚úï Bloated Electron, 500MB+ RAM</div>
        <div class="good">‚úì Lightweight, instant startup</div>
        <h3>Zero Bloat</h3>
        <p>No unnecessary animations eating your CPU. No background processes mining your attention. Just a clean, fast app that opens instantly.</p>
      </div>
      <div class="pain-card">
        <div class="bad">‚úï Basic features locked behind $10/mo</div>
        <div class="good">‚úì Generous free tier, fair pricing</div>
        <h3>Honest Pricing</h3>
        <p>Custom profiles, HD streaming, and 100MB uploads are free. Because basic communication features shouldn't require a subscription.</p>
      </div>
    </div>
  </section>

  <!-- Features Grid -->
  <section class="section animate-on-scroll" id="features">
    <div class="section-label">Features</div>
    <h2 class="section-title">Everything you need. Nothing you don't.</h2>
    <p class="section-sub">Powerful features that respect your privacy, your time, and your intelligence.</p>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon">üîí</div>
        <h3>End-to-End Encryption</h3>
        <p>Every message encrypted by default. Your conversations are yours ‚Äî not training data for an AI model.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üéôÔ∏è</div>
        <h3>Drop-In Voice</h3>
        <p>Crystal-clear voice channels with noise suppression. Join with one click, no ring-and-wait ritual needed.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üé®</div>
        <h3>Custom Themes</h3>
        <p>Dark, light, OLED, or create your own. Full CSS variable theming so your app looks exactly how you want.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">‚è∞</div>
        <h3>Scheduled Messages</h3>
        <p>Compose now, send later. Perfect for teams across time zones or announcements that need precise timing.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üîî</div>
        <h3>Smart Notifications</h3>
        <p>AI-powered notification priority. Important messages surface immediately; memes can wait until you're free.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">‚ö°</div>
        <h3>Zero Bloat</h3>
        <p>Under 50MB install. Sub-second startup. No mystery background processes. Your computer will thank you.</p>
      </div>
    </div>
  </section>

  <!-- App Preview -->
  <section class="section app-preview-section animate-on-scroll" id="app-preview">
    <div class="section-label">Preview</div>
    <h2 class="section-title">See it for yourself.</h2>
    <p class="section-sub" style="margin-left:auto;margin-right:auto;">A fully functional interface designed around the way people actually communicate.</p>
    <div class="app-preview-container">
      <div class="app-preview-mockup">
        <div class="mock-serverbar">
          <div class="mock-server" style="background:var(--accent-primary);color:#fff;">üè†</div>
          <div style="width:32px;height:2px;background:var(--glass-border);border-radius:1px;"></div>
          <div class="mock-server">üéÆ</div>
          <div class="mock-server">üìö</div>
          <div class="mock-server">üéµ</div>
          <div class="mock-server">üíª</div>
          <div class="mock-server" style="color:var(--accent-green);">+</div>
        </div>
        <div class="mock-sidebar">
          <h4>Gaming Hub</h4>
          <div class="mock-channel active"># general</div>
          <div class="mock-channel"># clips</div>
          <div class="mock-channel"># lfg</div>
          <div class="mock-channel">üîä Voice Chat (3)</div>
        </div>
        <div class="mock-chat">
          <div class="mock-msg"><div class="mock-avatar" style="background:var(--accent-green);font-size:14px;display:flex;align-items:center;justify-content:center;">S</div><div class="mock-msg-content"><span style="color:var(--accent-green);">Sarah</span><p>Just hit Diamond! üéâ Anyone want to queue up?</p></div></div>
          <div class="mock-msg"><div class="mock-avatar" style="background:var(--accent-secondary);font-size:14px;display:flex;align-items:center;justify-content:center;">M</div><div class="mock-msg-content"><span style="color:var(--accent-secondary);">Marcus</span><p>Let's gooo! I'm in. Voice channel?</p></div></div>
          <div class="mock-msg"><div class="mock-avatar" style="background:#faa61a;font-size:14px;display:flex;align-items:center;justify-content:center;">A</div><div class="mock-msg-content"><span style="color:#faa61a;">Alex</span><p>Already there! Joining now üéß</p></div></div>
          <div style="flex:1;"></div>
          <div style="background:var(--bg-tertiary);padding:10px;border-radius:8px;color:var(--text-muted);font-size:12px;">Message #general...</div>
        </div>
        <div class="mock-members">
          <h4>Online ‚Äî 3</h4>
          <div class="mock-member"><div class="mock-member-av" style="background:var(--accent-green);"></div> Sarah</div>
          <div class="mock-member"><div class="mock-member-av" style="background:var(--accent-secondary);"></div> Marcus</div>
          <div class="mock-member"><div class="mock-member-av" style="background:#faa61a;"></div> Alex</div>
          <h4 style="margin-top:12px;">Offline ‚Äî 2</h4>
          <div class="mock-member" style="opacity:0.4;"><div class="mock-member-av"></div> Jordan</div>
          <div class="mock-member" style="opacity:0.4;"><div class="mock-member-av"></div> Riley</div>
        </div>
      </div>
      <div class="preview-callout callout-1">Circular Icons ‚ú®</div>
      <div class="preview-callout callout-2">Warm Theme üåô</div>
      <div class="preview-callout callout-3">Clean, Spacious Layout üí´</div>
    </div>
    <div style="margin-top:32px;">
      <button class="btn-primary" onclick="enterApp()">Launch Full Demo ‚Üí</button>
    </div>
  </section>

  <!-- Pricing -->
  <section class="section animate-on-scroll" id="pricing">
    <div class="section-label">Pricing</div>
    <h2 class="section-title">Fair pricing. No tricks.</h2>
    <p class="section-sub">Everything Discord locks behind Nitro? That's free here.</p>
    <div class="pricing-grid">
      <div class="pricing-card">
        <h3>Free</h3>
        <div class="pricing-price">$0<span>/forever</span></div>
        <p class="pricing-desc">Everything you need for personal use and small communities.</p>
        <ul class="pricing-features">
          <li>100MB file uploads</li>
          <li>Custom profiles & avatars</li>
          <li>HD voice & video</li>
          <li>E2E encryption</li>
          <li>Custom themes</li>
          <li>Unlimited message history</li>
        </ul>
        <button class="pricing-btn outline" onclick="enterApp()">Get Started Free</button>
      </div>
      <div class="pricing-card featured">
        <div class="pricing-badge">Popular</div>
        <h3>Pro</h3>
        <div class="pricing-price">$4.99<span>/month</span></div>
        <p class="pricing-desc">For power users who want the extra edge.</p>
        <ul class="pricing-features">
          <li>Everything in Free</li>
          <li>500MB file uploads</li>
          <li>Custom animated avatars</li>
          <li>Scheduled messages</li>
          <li>Advanced notification AI</li>
          <li>Priority support</li>
        </ul>
        <button class="pricing-btn primary" onclick="enterApp()">Start Pro Trial</button>
      </div>
      <div class="pricing-card">
        <h3>Community</h3>
        <div class="pricing-price">$9.99<span>/month</span></div>
        <p class="pricing-desc">For server owners who want the best for their community.</p>
        <ul class="pricing-features">
          <li>Everything in Pro</li>
          <li>2GB file uploads</li>
          <li>Custom server branding</li>
          <li>Advanced analytics</li>
          <li>Moderation AI tools</li>
          <li>Vanity invite links</li>
        </ul>
        <button class="pricing-btn outline" onclick="enterApp()">Start Community Trial</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-grid">
      <div class="footer-brand">
        <div class="nav-logo">
          <svg viewBox="0 0 36 36" fill="none" width="28" height="28">
            <circle cx="18" cy="18" r="16" stroke="url(#logo-grad2)" stroke-width="2.5" fill="none"/>
            <path d="M8 18 Q12 10, 16 18 Q18 22, 20 18 Q24 10, 28 18" stroke="url(#logo-grad2)" stroke-width="2.5" fill="none" stroke-linecap="round"/>
            <defs><linearGradient id="logo-grad2" x1="0" y1="0" x2="36" y2="36"><stop offset="0%" stop-color="#7c5cff"/><stop offset="100%" stop-color="#ff6b6b"/></linearGradient></defs>
          </svg>
          <span>Pulse</span>
        </div>
        <p>Made for communities that matter. Built by people who actually use chat apps every day.</p>
      </div>
      <div class="footer-col">
        <h4>Product</h4>
        <a href="#">Download</a>
        <a href="#">Changelog</a>
        <a href="#">Status</a>
        <a href="#">Roadmap</a>
      </div>
      <div class="footer-col">
        <h4>Company</h4>
        <a href="#">About</a>
        <a href="#">Blog</a>
        <a href="#">Careers</a>
        <a href="#">Press</a>
      </div>
      <div class="footer-col">
        <h4>Legal</h4>
        <a href="#">Privacy</a>
        <a href="#">Terms</a>
        <a href="#">Security</a>
        <a href="#">GDPR</a>
      </div>
    </div>
    <div class="footer-bottom">
      &copy; 2026 Pulse. Made for communities that matter.
    </div>
  </footer>
</div>

<!-- ==================== APP UI ==================== -->
<div class="app-view members-visible" id="app-view">
  <!-- Server Bar -->
  <div class="server-bar" id="server-bar"></div>

  <!-- Channel Sidebar -->
  <div class="channel-sidebar">
    <div class="channel-header" id="channel-header">
      <span id="server-name">Gaming Hub</span>
      <svg viewBox="0 0 16 16"><path d="M4 6l4 4 4-4"/></svg>
    </div>
    <div class="e2e-badge">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
      End-to-End Encrypted
    </div>
    <div class="channel-list" id="channel-list"></div>
    <div class="user-panel">
      <div class="user-panel-avatar" onclick="showProfile(DATA.currentUser, event)">
        <div style="width:32px;height:32px;border-radius:50%;background:#7c5cff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:13px;color:#fff;">Y</div>
        <div class="status-dot status-online"></div>
      </div>
      <div class="user-panel-info">
        <div class="user-panel-name">You</div>
        <div class="user-panel-tag">#0001</div>
      </div>
      <div class="user-panel-actions">
        <button class="user-panel-btn" title="Mute">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1 1.93c-3.94-.49-7-3.85-7-7.93h2c0 3.31 2.69 6 6 6s6-2.69 6-6h2c0 4.08-3.06 7.44-7 7.93V20h4v2H8v-2h4v-4.07z"/></svg>
        </button>
        <button class="user-panel-btn" title="Deafen">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 1c-4.97 0-9 4.03-9 9v7c0 1.66 1.34 3 3 3h3v-8H5v-2c0-3.87 3.13-7 7-7s7 3.13 7 7v2h-4v8h3c1.66 0 3-1.34 3-3v-7c0-4.97-4.03-9-9-9z"/></svg>
        </button>
        <button class="user-panel-btn" title="Settings" onclick="openSettings()">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Chat Area -->
  <div class="chat-area">
    <div class="chat-header">
      <div class="chat-header-channel">
        <span class="hash">#</span>
        <span id="chat-channel-name">general</span>
      </div>
      <div class="chat-header-divider"></div>
      <div class="chat-header-topic" id="chat-topic">Welcome to the server! Be nice.</div>
      <div class="chat-header-actions">
        <button class="chat-header-btn" title="Search (Ctrl+K)" onclick="openSearch()">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
        </button>
        <button class="chat-header-btn" title="Pinned Messages">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 12V4h1V2H7v2h1v8l-2 2v2h5.2v6h1.6v-6H18v-2l-2-2z"/></svg>
        </button>
        <button class="chat-header-btn" title="Threads">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/></svg>
        </button>
        <button class="chat-header-btn" id="member-toggle-btn" title="Member List" onclick="toggleMembers()">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
        </button>
      </div>
    </div>
    <div class="chat-messages" id="chat-messages"></div>
    <div class="typing-indicator" id="typing-indicator"></div>
    <div class="chat-input-area">
      <div class="chat-input-wrapper" style="position:relative;">
        <button class="input-btn" title="Attach File">+</button>
        <textarea class="chat-input" id="message-input" placeholder="Message #general" rows="1" onkeydown="handleInputKey(event)" oninput="autoResize(this);updateCharCount()"></textarea>
        <span class="char-count" id="char-count"></span>
        <button class="input-btn" title="Schedule Message">üïê</button>
        <button class="input-btn" title="GIF">GIF</button>
        <button class="input-btn emoji-trigger" title="Emoji" onclick="toggleEmojiPicker()">üòä</button>
        <div class="emoji-picker" id="emoji-picker">
          <div class="emoji-picker-search"><input type="text" placeholder="Search emoji..." id="emoji-search" oninput="filterEmojis(this.value)"></div>
          <div class="emoji-tabs">
            <button class="emoji-tab active" data-cat="smileys">üòÄ</button>
            <button class="emoji-tab" data-cat="people">üëã</button>
            <button class="emoji-tab" data-cat="nature">üåø</button>
            <button class="emoji-tab" data-cat="food">üçï</button>
            <button class="emoji-tab" data-cat="activity">‚öΩ</button>
            <button class="emoji-tab" data-cat="objects">üí°</button>
          </div>
          <div class="emoji-grid" id="emoji-grid"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Member List -->
  <div class="member-list" id="member-list"></div>
</div>

<!-- Profile Card -->
<div class="profile-card" id="profile-card">
  <div class="profile-banner" id="profile-banner"></div>
  <div class="profile-avatar-wrap">
    <div class="profile-avatar" id="profile-avatar"></div>
  </div>
  <div class="profile-info">
    <div class="profile-name" id="profile-name"></div>
    <div class="profile-tag" id="profile-tag"></div>
    <div class="profile-bio" id="profile-bio"></div>
    <div class="profile-roles" id="profile-roles"></div>
  </div>
  <button class="profile-msg-btn">Message</button>
</div>

<!-- Settings Modal -->
<div class="modal-overlay" id="settings-modal">
  <div class="modal">
    <div class="modal-header">
      <h2>Settings</h2>
      <button class="modal-close" onclick="closeModal('settings-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="settings-grid">
        <div class="settings-section">
          <h3>Appearance</h3>
          <div class="theme-options">
            <div class="theme-option active" data-theme="dark" onclick="setTheme('dark')">
              <div class="theme-swatch" style="background:#1a1a2e;"></div>
              <span>Dark</span>
            </div>
            <div class="theme-option" data-theme="light" onclick="setTheme('light')">
              <div class="theme-swatch" style="background:#e8e8f0;"></div>
              <span>Light</span>
            </div>
            <div class="theme-option" data-theme="oled" onclick="setTheme('oled')">
              <div class="theme-swatch" style="background:#000000;"></div>
              <span>OLED</span>
            </div>
          </div>
        </div>
        <div class="settings-section">
          <h3>Notifications</h3>
          <div class="toggle-row"><span>Enable desktop notifications</span><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
          <div class="toggle-row"><span>Smart notification priority</span><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
          <div class="toggle-row"><span>Sound effects</span><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
        </div>
        <div class="settings-section">
          <h3>Privacy</h3>
          <div class="toggle-row"><span>End-to-end encryption</span><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
          <div class="toggle-row"><span>Show online status</span><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
          <div class="toggle-row"><span>Read receipts</span><div class="toggle-switch" onclick="this.classList.toggle('on')"></div></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Search Modal -->
<div class="modal-overlay search-modal" id="search-modal">
  <div class="modal">
    <div class="modal-header">
      <h2>Search</h2>
      <button class="modal-close" onclick="closeModal('search-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="search-input-wrap">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
        <input type="text" class="search-input" placeholder="Search messages..." autofocus>
      </div>
      <div class="search-filters">
        <span class="search-chip">from: user</span>
        <span class="search-chip">in: channel</span>
        <span class="search-chip">has: image</span>
        <span class="search-chip">has: link</span>
        <span class="search-chip">before: date</span>
        <span class="search-chip">after: date</span>
      </div>
      <div class="search-results">Start typing to search across all messages...</div>
    </div>
  </div>
</div>

<script>
// ========== Section 1: Data & State ==========
const EMOJIS = {
  smileys: ['üòÄ','üòÅ','üòÇ','ü§£','üòÉ','üòÑ','üòÖ','üòÜ','üòâ','üòä','üòã','üòé','ü§©','üòç','ü•∞','üòò','üòó','üòô','üòö','üôÇ','ü§î','ü§®','üòê','üòë','üò∂','üôÑ','üòè','üò£','üò•','üòÆ','ü§ê','üòØ','üò™','üò´','ü•±','üò¥','üòå','üòõ','üòú','ü§™','üòù','ü§ë','ü§ó','ü§≠','ü§´','ü§•','üò¨','üòí','üòà','üëø','üíÄ','‚ò†Ô∏è','üí©','ü§°','üëπ','üë∫','üëª','üëΩ','üëæ','ü§ñ'],
  people: ['üëã','ü§ö','üñêÔ∏è','‚úã','üññ','üëå','ü§å','ü§è','‚úåÔ∏è','ü§û','ü§ü','ü§ò','ü§ô','üëà','üëâ','üëÜ','üñï','üëá','‚òùÔ∏è','üëç','üëé','‚úä','üëä','ü§õ','ü§ú','üëè','üôå','üëê','ü§≤','ü§ù','üôè'],
  nature: ['üåø','üå±','üå≤','üå≥','üå¥','üåµ','üåæ','üå∑','üåπ','ü•Ä','üå∫','üå∏','üåº','üåª','üçÄ','üçÅ','üçÇ','üçÉ','üåç','üåô','‚≠ê','üåü','üí´','‚òÄÔ∏è','üå§Ô∏è','üåà','üî•','üíß','üåä'],
  food: ['üçï','üçî','üçü','üå≠','üçø','üßÇ','ü•ì','ü•ö','üç≥','ü•û','üßá','ü•ê','üçû','ü•ñ','ü•®','üßÄ','ü•ó','ü•ô','üåÆ','üåØ','üçù','üçú','üçõ','üçö','üç±','üç£','üçô','üçò','üçß','üç®','üéÇ','üç∞','üßÅ','üç©','üç™'],
  activity: ['‚öΩ','üèÄ','üèà','‚öæ','ü•é','üéæ','üèê','üèâ','ü•è','üé±','üèì','üè∏','üèí','ü•Ö','‚õ≥','üèπ','üé£','ü§ø','ü•ä','ü•ã','üéØ','üéÆ','üïπÔ∏è','üé≤','üß©','‚ôüÔ∏è','üé≠','üé®','üé¨','üé§','üéß','üéº','üéπ','ü•Å','üé∑'],
  objects: ['üí°','üî¶','üïØÔ∏è','üì±','üíª','‚å®Ô∏è','üñ•Ô∏è','üñ®Ô∏è','üì∑','üé•','üì∫','üìª','‚è∞','‚åö','üí∞','üíé','üîß','üî®','üõ†Ô∏è','üíä','üîë','üóùÔ∏è','üö™','üì¶','üì´','üìù','üìö','üìñ','üîó','üìé','‚úÇÔ∏è','üóëÔ∏è']
};
const AVATARS = ['#7c5cff','#ff6b6b','#43b581','#faa61a','#f04747','#3498db','#e91e63','#9b59b6','#1abc9c','#e67e22','#2ecc71','#00bcd4','#ff9800','#8bc34a','#ff5722'];

const DATA = {
  currentUser: { id:'you', name:'You', tag:'#0001', color:'#7c5cff', status:'online', bio:'Just vibing in Pulse.', roles:['Member'] },
  servers: [
    { id:'home', name:'Direct Messages', icon:'üè†', isHome: true },
    { id:'gaming', name:'Gaming Hub', icon:'üéÆ', channels: [
      { cat:'TEXT CHANNELS', items:[
        { id:'general', name:'general', topic:'Welcome to Gaming Hub! Be respectful and have fun.', unread: false },
        { id:'clips', name:'clips', topic:'Share your best gaming moments.', unread: true },
        { id:'lfg', name:'looking-for-group', topic:'Find teammates here.', unread: false },
        { id:'memes', name:'memes', topic:'Gaming memes only. No spam.', unread: false }
      ]},
      { cat:'VOICE CHANNELS', items:[
        { id:'vc1', name:'Voice Chat', type:'voice', users:['Sarah','Marcus'] },
        { id:'vc2', name:'AFK', type:'voice', users:[] }
      ]}
    ], badge: 3 },
    { id:'study', name:'Study Group', icon:'üìö', channels: [
      { cat:'TEXT CHANNELS', items:[
        { id:'s-general', name:'general', topic:'Study group discussion.', unread: false },
        { id:'s-resources', name:'resources', topic:'Share study materials.', unread: true },
        { id:'s-help', name:'homework-help', topic:'Ask questions, get answers.', unread: false }
      ]},
      { cat:'VOICE CHANNELS', items:[
        { id:'s-vc1', name:'Study Room', type:'voice', users:['Emma'] },
        { id:'s-vc2', name:'Quiet Zone', type:'voice', users:[] }
      ]}
    ], badge: 0 },
    { id:'music', name:'Music Lounge', icon:'üéµ', channels: [
      { cat:'TEXT CHANNELS', items:[
        { id:'m-general', name:'general', topic:'All things music.', unread: false },
        { id:'m-share', name:'share-music', topic:'Drop your latest finds.', unread: false },
        { id:'m-production', name:'production', topic:'For producers and beatmakers.', unread: true },
        { id:'m-vinyl', name:'vinyl-collectors', topic:'Analog appreciation.', unread: false }
      ]},
      { cat:'VOICE CHANNELS', items:[
        { id:'m-vc1', name:'Listening Party', type:'voice', users:['DJ_Nova','BeatSmith'] },
        { id:'m-vc2', name:'Jam Session', type:'voice', users:[] }
      ]}
    ], badge: 1 },
    { id:'dev', name:'Dev Team', icon:'üíª', channels: [
      { cat:'TEXT CHANNELS', items:[
        { id:'d-general', name:'general', topic:'Dev team chat.', unread: false },
        { id:'d-frontend', name:'frontend', topic:'React, Vue, and friends.', unread: false },
        { id:'d-backend', name:'backend', topic:'APIs, databases, infra.', unread: true },
        { id:'d-bugs', name:'bug-reports', topic:'Report bugs here.', unread: false },
        { id:'d-deploys', name:'deployments', topic:'CI/CD and release notes.', unread: false }
      ]},
      { cat:'VOICE CHANNELS', items:[
        { id:'d-vc1', name:'Standup Room', type:'voice', users:[] },
        { id:'d-vc2', name:'Pair Programming', type:'voice', users:['CodeWitch'] }
      ]}
    ], badge: 0 },
    { id:'art', name:'Art Corner', icon:'üé®', channels: [
      { cat:'TEXT CHANNELS', items:[
        { id:'a-general', name:'general', topic:'Art community chat.', unread: false },
        { id:'a-showcase', name:'showcase', topic:'Share your artwork!', unread: false },
        { id:'a-critique', name:'critique', topic:'Give and receive feedback.', unread: false },
        { id:'a-commissions', name:'commissions', topic:'Commission info and requests.', unread: true }
      ]},
      { cat:'VOICE CHANNELS', items:[
        { id:'a-vc1', name:'Drawing Together', type:'voice', users:['PixelArtist'] }
      ]}
    ], badge: 2 }
  ],
  members: [
    { id:'sarah', name:'Sarah', tag:'#1234', color:'#43b581', status:'online', bio:'Competitive gamer. Diamond rank.', roles:['Admin','Gamer'], activity:'Playing Valorant' },
    { id:'marcus', name:'Marcus', tag:'#5678', color:'#ff6b6b', status:'online', bio:'Casual gamer and meme lord.', roles:['Moderator','Gamer'], activity:'In Voice Chat' },
    { id:'alex', name:'Alex', tag:'#9012', color:'#faa61a', status:'online', bio:'FPS enthusiast.', roles:['Member'], activity:'Playing CS2' },
    { id:'emma', name:'Emma', tag:'#3456', color:'#3498db', status:'online', bio:'Study hard, play harder.', roles:['Member'], activity:'Studying' },
    { id:'jordan', name:'Jordan', tag:'#7890', color:'#e91e63', status:'idle', bio:'AFK but not really.', roles:['Moderator'], activity:null },
    { id:'nova', name:'DJ_Nova', tag:'#2345', color:'#9b59b6', status:'online', bio:'Beats and vibes.', roles:['Member'], activity:'Listening to Spotify' },
    { id:'beatsmith', name:'BeatSmith', tag:'#6789', color:'#1abc9c', status:'online', bio:'Producer | FL Studio', roles:['Member'], activity:'Making beats' },
    { id:'codewitch', name:'CodeWitch', tag:'#0123', color:'#e67e22', status:'online', bio:'Full-stack dev. Rust enthusiast.', roles:['Admin','Developer'], activity:'VS Code' },
    { id:'pixel', name:'PixelArtist', tag:'#4567', color:'#2ecc71', status:'online', bio:'Pixel art and retro vibes.', roles:['Member'], activity:'Drawing' },
    { id:'riley', name:'Riley', tag:'#8901', color:'#00bcd4', status:'dnd', bio:'Do not disturb. In the zone.', roles:['Member'], activity:'Streaming' },
    { id:'casey', name:'Casey', tag:'#2468', color:'#ff9800', status:'offline', bio:'Offline but never forgotten.', roles:['Member'], activity:null },
    { id:'morgan', name:'Morgan', tag:'#1357', color:'#8bc34a', status:'offline', bio:'Part-time gamer.', roles:['Member'], activity:null },
    { id:'taylor', name:'Taylor', tag:'#9753', color:'#ff5722', status:'offline', bio:'Art and code.', roles:['Member'], activity:null }
  ],
  messages: {
    'general': [
      { id:1, user:'sarah', text:'Just hit Diamond! üéâ Anyone want to queue up?', time:'Today at 2:14 PM', reactions:[{emoji:'üéâ',count:4,active:true},{emoji:'üî•',count:2,active:false}] },
      { id:2, user:'marcus', text:'Congrats!! Let\'s gooo! I\'m down for some ranked.', time:'Today at 2:15 PM', reactions:[{emoji:'üëç',count:1,active:false}] },
      { id:3, user:'alex', text:'Already in voice! Warming up with some deathmatches.', time:'Today at 2:16 PM', reactions:[] },
      { id:4, user:'sarah', text:'Perfect. Joining now. @Marcus you playing Sage again?', time:'Today at 2:18 PM', reactions:[{emoji:'üòÇ',count:2,active:false}] },
      { id:5, user:'marcus', text:'You know it. Someone\'s gotta keep you alive üíÄ', time:'Today at 2:18 PM', reactions:[{emoji:'üíÄ',count:3,active:true},{emoji:'üòÇ',count:5,active:false}] },
      { id:6, user:'system', text:'Alex started a thread: Team Comp Discussion', time:'Today at 2:20 PM', isSystem:true },
      { id:7, user:'emma', text:'Good luck everyone! I\'ll spectate from study hall üìö', time:'Today at 2:22 PM', reactions:[{emoji:'‚ù§Ô∏è',count:2,active:false}] },
      { id:8, user:'alex', text:'Check out this insane clutch from yesterday:', time:'Today at 2:25 PM', reactions:[], embed:{title:'Insane 1v4 Clutch - Valorant',desc:'Alex pulls off an incredible 1v4 clutch on Ascent. Full video on YouTube.'} },
      { id:9, user:'jordan', text:'Nice clip! That movement was clean üéØ', time:'Today at 2:28 PM', reactions:[{emoji:'üéØ',count:1,active:false}], thread:{count:3,preview:'Click to see replies'} },
      { id:10, user:'newdivider', text:'New Messages', isDivider:true },
      { id:11, user:'riley', text:'Anyone streaming tonight? I was thinking of doing a community game night on my channel.', time:'Today at 5:30 PM', reactions:[{emoji:'üéÆ',count:4,active:true},{emoji:'üëÄ',count:3,active:false}] },
      { id:12, user:'sarah', text:'I\'m so down for that! What time?', time:'Today at 5:32 PM', reactions:[] },
      { id:13, user:'marcus', text:'Count me in. Also, has anyone tried the new map? It looks gorgeous.', time:'Today at 5:33 PM', reactions:[] },
      { id:14, user:'alex', text:'The new map is amazing. Here\'s a pro tip: use the left corridor for flanks, nobody expects it.', time:'Today at 5:35 PM', reactions:[{emoji:'üí°',count:2,active:false},{emoji:'üëÄ',count:1,active:false}] },
      { id:15, user:'nova', text:'Hey gamers! Just finished a new track inspired by game soundtracks. Want me to drop it in #share-music?', time:'Today at 5:40 PM', reactions:[{emoji:'üéµ',count:3,active:false},{emoji:'üî•',count:2,active:true}] }
    ],
    'clips': [
      { id:1, user:'alex', text:'My best clip this week ‚Äî 4K headshot ace üéØ', time:'Today at 11:00 AM', reactions:[{emoji:'üî•',count:7,active:false},{emoji:'üòÆ',count:4,active:true}] },
      { id:2, user:'marcus', text:'Bro what üíÄ That flick was inhuman', time:'Today at 11:02 AM', reactions:[] },
      { id:3, user:'sarah', text:'Post the full VOD! I need to study your crosshair placement.', time:'Today at 11:05 AM', reactions:[{emoji:'üìù',count:1,active:false}] },
      { id:4, user:'riley', text:'Here\'s mine ‚Äî a cheeky knife kill in round 12:', time:'Today at 12:30 PM', reactions:[{emoji:'üî™',count:5,active:false},{emoji:'üòÇ',count:8,active:true}], embed:{title:'The Most Disrespectful Knife Kill',desc:'Riley sneaks up for the most BM knife kill of the season.'} },
      { id:5, user:'jordan', text:'I have no clips. Only pain. I deranked 3 times today.', time:'Today at 1:15 PM', reactions:[{emoji:'üíÄ',count:6,active:false},{emoji:'üò¢',count:3,active:false}] }
    ],
    'looking-for-group': [
      { id:1, user:'emma', text:'LFG for casual unrated! I\'m Gold 2. No toxicity please üôè', time:'Today at 3:00 PM', reactions:[{emoji:'üëã',count:2,active:false}] },
      { id:2, user:'alex', text:'I\'ll join! Give me 5 minutes to finish this match.', time:'Today at 3:02 PM', reactions:[{emoji:'üëç',count:1,active:true}] },
      { id:3, user:'casey', text:'Need 2 more for a 5-stack. Diamond+ preferred. DM me.', time:'Yesterday at 8:00 PM', reactions:[{emoji:'üíé',count:1,active:false}] }
    ],
    'memes': [
      { id:1, user:'marcus', text:'When you\'re in a 1v5 and your whole team is backseat gaming:', time:'Today at 10:00 AM', reactions:[{emoji:'üòÇ',count:12,active:true},{emoji:'üíÄ',count:8,active:false}] },
      { id:2, user:'jordan', text:'"Just click heads" ‚Äî every helpful teammate ever', time:'Today at 10:05 AM', reactions:[{emoji:'ü§°',count:6,active:false}] },
      { id:3, user:'alex', text:'My aim at 2 AM vs my aim at 2 PM: same player, completely different universe', time:'Today at 11:30 AM', reactions:[{emoji:'üòÇ',count:9,active:true},{emoji:'üíØ',count:3,active:false}] },
      { id:4, user:'riley', text:'Patch notes: *breathes*\nReddit: "GAME IS DEAD"', time:'Today at 12:00 PM', reactions:[{emoji:'üì∞',count:4,active:false},{emoji:'üòÇ',count:7,active:false}] }
    ],
    's-general': [
      { id:1, user:'emma', text:'Hey everyone! Midterms are coming up. Who\'s forming a study group?', time:'Today at 9:00 AM', reactions:[{emoji:'üìö',count:3,active:false}] },
      { id:2, user:'codewitch', text:'I can help with CS topics. Data structures, algorithms, etc.', time:'Today at 9:15 AM', reactions:[{emoji:'üôè',count:4,active:true}] },
      { id:3, user:'taylor', text:'I need help with calculus. Anyone good at integration?', time:'Today at 9:30 AM', reactions:[{emoji:'‚úã',count:2,active:false}] }
    ],
    's-resources': [
      { id:1, user:'emma', text:'Here\'s a great cheat sheet for linear algebra:', time:'Today at 10:00 AM', reactions:[{emoji:'‚≠ê',count:5,active:true}], embed:{title:'Linear Algebra Cheat Sheet',desc:'Comprehensive guide covering vectors, matrices, eigenvalues, and more.'} },
      { id:2, user:'codewitch', text:'Free MIT OCW courses for CS: https://ocw.mit.edu', time:'Today at 10:30 AM', reactions:[{emoji:'üî•',count:3,active:false}] }
    ],
    's-homework-help': [
      { id:1, user:'taylor', text:'Can someone explain Big O notation? I keep getting confused between O(n) and O(n log n).', time:'Today at 2:00 PM', reactions:[] },
      { id:2, user:'codewitch', text:'Think of it this way: O(n) means you look at each item once. O(n log n) means for each item, you do `log n` work. Like sorting ‚Äî you compare each element, but use divide-and-conquer to reduce comparisons.', time:'Today at 2:10 PM', reactions:[{emoji:'üí°',count:3,active:true},{emoji:'üß†',count:2,active:false}] },
      { id:3, user:'taylor', text:'That actually makes so much sense. Thank you!', time:'Today at 2:15 PM', reactions:[{emoji:'‚ù§Ô∏è',count:1,active:false}] }
    ],
    'm-general': [
      { id:1, user:'nova', text:'New album drop this Friday! Who\'s excited?', time:'Today at 11:00 AM', reactions:[{emoji:'üéµ',count:5,active:true},{emoji:'üî•',count:3,active:false}] },
      { id:2, user:'beatsmith', text:'Been working on some lo-fi beats. Perfect study music vibes.', time:'Today at 11:30 AM', reactions:[{emoji:'üéß',count:4,active:false}] }
    ],
    'm-share-music': [
      { id:1, user:'nova', text:'Check out this track I just finished ‚Äî "Midnight Pulse":', time:'Today at 1:00 PM', reactions:[{emoji:'üî•',count:8,active:true},{emoji:'üéµ',count:5,active:false}], embed:{title:'Midnight Pulse ‚Äî DJ_Nova',desc:'A synthwave journey through neon-lit streets. 3:42'} },
      { id:2, user:'beatsmith', text:'The synth layering on this is incredible. What DAW are you using?', time:'Today at 1:15 PM', reactions:[] },
      { id:3, user:'nova', text:'Ableton Live 12 with Serum for the synths. Happy to share the preset pack!', time:'Today at 1:20 PM', reactions:[{emoji:'üôè',count:3,active:false}] }
    ],
    'm-production': [
      { id:1, user:'beatsmith', text:'Hot take: you don\'t need expensive plugins to make great music. Stock plugins are incredibly powerful now.', time:'Today at 10:00 AM', reactions:[{emoji:'üíØ',count:6,active:false},{emoji:'üî•',count:2,active:true}] },
      { id:2, user:'nova', text:'Agreed, but Serum is worth every penny.', time:'Today at 10:10 AM', reactions:[{emoji:'üòÇ',count:3,active:false}] }
    ],
    'm-vinyl-collectors': [
      { id:1, user:'pixel', text:'Just found a mint condition Dark Side of the Moon pressing at a thrift store for $5!', time:'Yesterday at 4:00 PM', reactions:[{emoji:'üòÆ',count:4,active:true},{emoji:'üíé',count:2,active:false}] }
    ],
    'd-general': [
      { id:1, user:'codewitch', text:'Morning team! Sprint review at 3pm today. Please update your tickets.', time:'Today at 9:00 AM', reactions:[{emoji:'üëç',count:5,active:true}] },
      { id:2, user:'emma', text:'PR #142 is ready for review. Added the new auth middleware.', time:'Today at 9:30 AM', reactions:[{emoji:'üëÄ',count:2,active:false}], thread:{count:5,preview:'5 comments on this PR'} },
      { id:3, user:'codewitch', text:'Nice work! I\'ll review it after lunch. The approach looks clean from the description.', time:'Today at 9:35 AM', reactions:[] }
    ],
    'd-frontend': [
      { id:1, user:'taylor', text:'Should we migrate from Webpack to Vite? Build times are getting painful.', time:'Today at 10:00 AM', reactions:[{emoji:'‚ö°',count:4,active:true}] },
      { id:2, user:'codewitch', text:'Yes, let\'s do it. I\'ll create a ticket. Vite\'s HMR is a game changer.', time:'Today at 10:10 AM', reactions:[{emoji:'üéâ',count:3,active:false}] }
    ],
    'd-backend': [
      { id:1, user:'codewitch', text:'Database migration complete. All indexes rebuilt. Response times down 40%.', time:'Today at 8:00 AM', reactions:[{emoji:'üöÄ',count:6,active:true},{emoji:'üî•',count:4,active:false}] },
      { id:2, user:'emma', text:'The API feels so much snappier now. Great work!', time:'Today at 8:30 AM', reactions:[] }
    ],
    'd-bug-reports': [
      { id:1, user:'alex', text:'Bug: login page crashes on Safari 17.4 when using passkeys. Steps to reproduce in the thread.', time:'Today at 11:00 AM', reactions:[], thread:{count:8,preview:'Investigation ongoing'} },
      { id:2, user:'codewitch', text:'Thanks for the detailed report. This is likely related to the WebAuthn API changes. I\'ll look into it.', time:'Today at 11:15 AM', reactions:[{emoji:'üîç',count:1,active:false}] }
    ],
    'd-deployments': [
      { id:1, user:'system', text:'‚úÖ v2.4.1 deployed to production successfully.', time:'Today at 7:00 AM', isSystem:true },
      { id:2, user:'codewitch', text:'Release notes: Fixed auth flow, improved API caching, new dark theme.', time:'Today at 7:05 AM', reactions:[{emoji:'üéâ',count:4,active:false}] }
    ],
    'a-general': [
      { id:1, user:'pixel', text:'Good morning artists! Working on a new pixel art series today. Theme: cyberpunk cats üê±', time:'Today at 9:00 AM', reactions:[{emoji:'üòç',count:5,active:true},{emoji:'üê±',count:3,active:false}] },
      { id:2, user:'taylor', text:'That sounds amazing! Can\'t wait to see it.', time:'Today at 9:10 AM', reactions:[] }
    ],
    'a-showcase': [
      { id:1, user:'pixel', text:'Finished my latest piece! "Neon Alley Cat" ‚Äî 64x64 pixel art with 12 color palette.', time:'Today at 2:00 PM', reactions:[{emoji:'üî•',count:8,active:false},{emoji:'üòç',count:6,active:true},{emoji:'üé®',count:4,active:false}] },
      { id:2, user:'taylor', text:'The color palette is gorgeous. How do you choose your limited palettes?', time:'Today at 2:15 PM', reactions:[] },
      { id:3, user:'pixel', text:'I start with a base mood color, then pick 3-4 harmonious tones and add highlights/shadows. Less is more with pixel art!', time:'Today at 2:20 PM', reactions:[{emoji:'üí°',count:3,active:false}] }
    ],
    'a-critique': [
      { id:1, user:'taylor', text:'Working on a digital painting. The lighting feels off. Any feedback?', time:'Today at 3:00 PM', reactions:[] },
      { id:2, user:'pixel', text:'Try making your light source more directional. Right now the shadows feel flat ‚Äî add some ambient occlusion in the crevices.', time:'Today at 3:15 PM', reactions:[{emoji:'üôè',count:1,active:true}] }
    ],
    'a-commissions': [
      { id:1, user:'pixel', text:'Commission slots open! Pixel art portraits: $25. Full scenes: $50. DM me for details.', time:'Today at 10:00 AM', reactions:[{emoji:'üí∞',count:2,active:false},{emoji:'üé®',count:3,active:false}] }
    ]
  }
};

// State
const state = {
  activeServer: 'gaming',
  activeChannel: 'general',
  theme: 'dark',
  membersVisible: true,
  emojiPickerOpen: false,
  profileCardOpen: false,
  collapsedCategories: new Set()
};

// ========== Section 2: Render Functions ==========
function getMember(id) {
  if (id === 'you') return DATA.currentUser;
  return DATA.members.find(m => m.id === id) || DATA.currentUser;
}

function renderServerBar() {
  const bar = document.getElementById('server-bar');
  let html = '';
  DATA.servers.forEach((s, i) => {
    if (s.isHome) {
      html += `<div class="server-home ${state.activeServer === s.id ? 'active' : ''}" onclick="switchServer('${s.id}')" title="${s.name}">
        <svg viewBox="0 0 24 24"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" fill="currentColor"/></svg>
      </div>`;
      html += '<div class="server-separator"></div>';
    } else {
      const isActive = state.activeServer === s.id;
      const hasNotif = s.badge > 0 && !isActive;
      html += `<div class="server-icon-wrap ${isActive ? 'active' : ''} ${hasNotif ? 'has-notification' : ''}">
        <div class="server-pill"></div>
        <div class="server-icon" onclick="switchServer('${s.id}')" title="${s.name}">${s.icon}</div>
        ${s.badge > 0 && !isActive ? `<div class="server-badge">${s.badge}</div>` : ''}
      </div>`;
    }
  });
  html += '<div class="server-add" onclick="alert(\'Create Server coming soon!\')">+</div>';
  bar.innerHTML = html;
}

function renderChannels() {
  const list = document.getElementById('channel-list');
  const server = DATA.servers.find(s => s.id === state.activeServer);
  if (!server || !server.channels) { list.innerHTML = '<div style="padding:16px;color:var(--text-muted);font-size:14px;">Select a server to see channels.</div>'; return; }
  document.getElementById('server-name').textContent = server.name;
  let html = '';
  server.channels.forEach(cat => {
    const collapsed = state.collapsedCategories.has(cat.cat);
    html += `<div class="channel-category ${collapsed ? 'collapsed' : ''}" onclick="toggleCategory('${cat.cat}')">
      <svg viewBox="0 0 10 10"><path d="M2 3l3 3 3-3"/></svg> ${cat.cat}
    </div>`;
    if (!collapsed) {
      cat.items.forEach(ch => {
        if (ch.type === 'voice') {
          html += `<div class="channel-item" style="cursor:default;">
            <span class="hash">üîä</span>
            <span class="channel-name">${ch.name}</span>
            <span style="font-size:11px;color:var(--text-muted);">${ch.users.length > 0 ? ch.users.length : ''}</span>
          </div>`;
          if (ch.users.length > 0) {
            html += '<div class="voice-users">';
            ch.users.forEach(u => {
              html += `<div class="voice-user"><div class="voice-user-av" style="background:${AVATARS[u.charCodeAt(0) % AVATARS.length]};"></div>${u}</div>`;
            });
            html += '</div>';
          }
        } else {
          const isActive = state.activeChannel === ch.id;
          html += `<div class="channel-item ${isActive ? 'active' : ''}" onclick="switchChannel('${ch.id}','${ch.name}','${ch.topic.replace(/'/g,"\\'")}')">
            <span class="hash">#</span>
            <span class="channel-name">${ch.name}</span>
            ${ch.unread && !isActive ? '<div class="unread-dot"></div>' : ''}
          </div>`;
        }
      });
    }
  });
  list.innerHTML = html;
}

function renderMessages() {
  const container = document.getElementById('chat-messages');
  const msgs = DATA.messages[state.activeChannel] || [];
  let html = '';
  let lastUser = null;
  msgs.forEach((msg, i) => {
    if (msg.isDivider) {
      html += `<div class="new-messages-divider"><span>New Messages</span></div>`;
      lastUser = null;
      return;
    }
    if (msg.isSystem) {
      html += `<div class="system-message">
        <svg viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
        <span>${msg.text}</span>
        <span style="margin-left:auto;font-size:11px;">${msg.time}</span>
      </div>`;
      lastUser = null;
      return;
    }
    const member = getMember(msg.user);
    const isGrouped = lastUser === msg.user;
    const avatarColor = member.color || AVATARS[0];
    const initial = member.name.charAt(0).toUpperCase();

    html += `<div class="message-group ${isGrouped ? 'continued' : 'first-in-group'}">`;
    if (!isGrouped) {
      html += `<div class="msg-avatar" style="background:${avatarColor}" onclick="showProfile(DATA.members.find(m=>m.id==='${msg.user}')||DATA.currentUser, event)">${initial}</div>`;
    }
    html += '<div class="msg-body">';
    if (!isGrouped) {
      html += `<div class="msg-header">
        <span class="msg-username" style="color:${avatarColor}" onclick="showProfile(DATA.members.find(m=>m.id==='${msg.user}')||DATA.currentUser, event)">${member.name}</span>
        <span class="msg-timestamp">${msg.time}</span>
      </div>`;
    }
    html += `<div class="msg-text">${formatText(msg.text)}</div>`;
    if (msg.embed) {
      html += `<div class="msg-embed">
        <div class="msg-embed-title">${msg.embed.title}</div>
        <div class="msg-embed-desc">${msg.embed.desc}</div>
      </div>`;
    }
    if (msg.reactions && msg.reactions.length > 0) {
      html += '<div class="msg-reactions">';
      msg.reactions.forEach((r, ri) => {
        html += `<button class="msg-reaction ${r.active ? 'active' : ''}" onclick="toggleReaction(${i},${ri})">
          <span>${r.emoji}</span><span class="count">${r.count}</span>
        </button>`;
      });
      html += '</div>';
    }
    if (msg.thread) {
      html += `<div class="msg-thread">üí¨ ${msg.thread.count} replies ‚Äî ${msg.thread.preview}</div>`;
    }
    html += '</div>';
    html += `<div class="msg-actions">
      <button class="msg-action-btn" title="React">üòÄ</button>
      <button class="msg-action-btn" title="Reply">‚Ü©Ô∏è</button>
      <button class="msg-action-btn" title="Thread">üßµ</button>
      <button class="msg-action-btn" title="More">‚ãØ</button>
    </div>`;
    html += '</div>';
    lastUser = msg.user;
  });
  container.innerHTML = html;
  container.scrollTop = container.scrollHeight;
}

function renderMembers() {
  const container = document.getElementById('member-list');
  const groups = { Admin: [], Moderator: [], Online: [], Offline: [] };
  DATA.members.forEach(m => {
    if (m.roles.includes('Admin')) groups.Admin.push(m);
    else if (m.roles.includes('Moderator')) groups.Moderator.push(m);
    else if (m.status === 'offline') groups.Offline.push(m);
    else groups.Online.push(m);
  });
  let html = '';
  Object.entries(groups).forEach(([role, members]) => {
    if (members.length === 0) return;
    html += `<div class="member-role-group">
      <div class="member-role-header">${role.toUpperCase()} ‚Äî ${members.length}</div>`;
    members.forEach(m => {
      const statusClass = 'status-' + m.status;
      const isOffline = m.status === 'offline';
      html += `<div class="member-item ${isOffline ? 'offline' : ''}" onclick="showProfile(DATA.members.find(x=>x.id==='${m.id}'), event)">
        <div class="member-avatar" style="background:${m.color}">
          ${m.name.charAt(0)}
          <div class="status-dot ${statusClass}"></div>
        </div>
        <div class="member-info">
          <div class="member-name" style="color:${isOffline ? 'var(--text-muted)' : m.color}">${m.name}</div>
          ${m.activity ? `<div class="member-activity">${m.activity}</div>` : ''}
        </div>
      </div>`;
    });
    html += '</div>';
  });
  container.innerHTML = html;
}

function renderEmojiGrid(category) {
  const grid = document.getElementById('emoji-grid');
  const emojis = EMOJIS[category || 'smileys'];
  grid.innerHTML = emojis.map(e => `<div class="emoji-item" onclick="insertEmoji('${e}')">${e}</div>`).join('');
}

function formatText(text) {
  return text
    .replace(/`([^`]+)`/g, '<code>$1</code>')
    .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
    .replace(/\*([^*]+)\*/g, '<em>$1</em>')
    .replace(/@(\w+)/g, '<span style="background:rgba(124,92,255,0.2);color:var(--accent-primary);padding:0 4px;border-radius:3px;cursor:pointer;">@$1</span>');
}

// ========== Section 3: Event Handlers ==========
function switchServer(id) {
  state.activeServer = id;
  const server = DATA.servers.find(s => s.id === id);
  if (server && server.channels) {
    const firstText = server.channels.find(c => c.items.some(i => !i.type));
    if (firstText) {
      const ch = firstText.items.find(i => !i.type);
      if (ch) { state.activeChannel = ch.id; updateChatHeader(ch.name, ch.topic); }
    }
  }
  if (server) server.badge = 0;
  renderServerBar();
  renderChannels();
  renderMessages();
}

function switchChannel(id, name, topic) {
  state.activeChannel = id;
  updateChatHeader(name, topic);
  renderChannels();
  renderMessages();
  document.getElementById('message-input').placeholder = `Message #${name}`;
}

function updateChatHeader(name, topic) {
  document.getElementById('chat-channel-name').textContent = name;
  document.getElementById('chat-topic').textContent = topic;
}

function toggleCategory(cat) {
  if (state.collapsedCategories.has(cat)) state.collapsedCategories.delete(cat);
  else state.collapsedCategories.add(cat);
  renderChannels();
}

function toggleMembers() {
  state.membersVisible = !state.membersVisible;
  const app = document.getElementById('app-view');
  const btn = document.getElementById('member-toggle-btn');
  if (state.membersVisible) {
    app.classList.add('members-visible');
    btn.classList.add('active');
  } else {
    app.classList.remove('members-visible');
    btn.classList.remove('active');
  }
}

function toggleReaction(msgIdx, reactionIdx) {
  const msgs = DATA.messages[state.activeChannel];
  if (!msgs || !msgs[msgIdx]) return;
  const r = msgs[msgIdx].reactions[reactionIdx];
  if (!r) return;
  r.active = !r.active;
  r.count += r.active ? 1 : -1;
  renderMessages();
}

function showProfile(member, event) {
  if (!member) return;
  event && event.stopPropagation();
  const card = document.getElementById('profile-card');
  document.getElementById('profile-banner').style.background = `linear-gradient(135deg, ${member.color}, ${member.color}88)`;
  document.getElementById('profile-avatar').style.background = member.color;
  document.getElementById('profile-avatar').textContent = member.name.charAt(0);
  document.getElementById('profile-name').textContent = member.name;
  document.getElementById('profile-tag').textContent = member.tag || '';
  document.getElementById('profile-bio').textContent = member.bio || '';
  const rolesHtml = (member.roles || []).map(r => {
    const color = r === 'Admin' ? '#ff6b6b' : r === 'Moderator' ? '#faa61a' : r === 'Developer' ? '#3498db' : '#43b581';
    return `<span class="profile-role" style="color:${color};border-color:${color}40;background:${color}15;">${r}</span>`;
  }).join('');
  document.getElementById('profile-roles').innerHTML = rolesHtml;
  const rect = event ? event.target.getBoundingClientRect() : { left: 200, top: 200 };
  let left = rect.right + 12;
  let top = rect.top;
  if (left + 320 > window.innerWidth) left = rect.left - 332;
  if (top + 300 > window.innerHeight) top = window.innerHeight - 310;
  if (top < 10) top = 10;
  card.style.left = left + 'px';
  card.style.top = top + 'px';
  card.classList.add('open');
  state.profileCardOpen = true;
}

function setTheme(theme) {
  state.theme = theme;
  if (theme === 'dark') document.documentElement.removeAttribute('data-theme');
  else document.documentElement.setAttribute('data-theme', theme);
  document.querySelectorAll('.theme-option').forEach(el => {
    el.classList.toggle('active', el.dataset.theme === theme);
  });
}

function openSettings() { document.getElementById('settings-modal').classList.add('open'); }
function openSearch() { document.getElementById('search-modal').classList.add('open'); }
function closeModal(id) { document.getElementById(id).classList.remove('open'); }

function toggleEmojiPicker() {
  state.emojiPickerOpen = !state.emojiPickerOpen;
  const picker = document.getElementById('emoji-picker');
  picker.classList.toggle('open', state.emojiPickerOpen);
  if (state.emojiPickerOpen) renderEmojiGrid('smileys');
}

function insertEmoji(emoji) {
  const input = document.getElementById('message-input');
  input.value += emoji;
  input.focus();
  state.emojiPickerOpen = false;
  document.getElementById('emoji-picker').classList.remove('open');
}

function filterEmojis(query) {
  if (!query) { renderEmojiGrid('smileys'); return; }
  const all = Object.values(EMOJIS).flat();
  const grid = document.getElementById('emoji-grid');
  grid.innerHTML = all.slice(0, 40).map(e => `<div class="emoji-item" onclick="insertEmoji('${e}')">${e}</div>`).join('');
}

function handleInputKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
}

function sendMessage() {
  const input = document.getElementById('message-input');
  const text = input.value.trim();
  if (!text) return;
  const msgs = DATA.messages[state.activeChannel];
  if (msgs) {
    msgs.push({ id: msgs.length + 1, user: 'you', text: text, time: 'Just now', reactions: [] });
  }
  input.value = '';
  input.style.height = 'auto';
  document.getElementById('char-count').textContent = '';
  renderMessages();
}

function autoResize(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 200) + 'px';
}

function updateCharCount() {
  const input = document.getElementById('message-input');
  const count = input.value.length;
  const el = document.getElementById('char-count');
  if (count === 0) { el.textContent = ''; return; }
  el.textContent = count + '/2000';
  el.className = 'char-count' + (count > 1800 ? ' warn' : '') + (count > 2000 ? ' over' : '');
}

// ========== Section 4: Landing Page Interactions ==========
function enterApp() {
  document.body.classList.add('in-app');
  renderAll();
}

function exitApp() {
  document.body.classList.remove('in-app');
}

// Scroll animations
function handleScroll() {
  const navbar = document.getElementById('navbar');
  if (navbar) navbar.classList.toggle('scrolled', window.scrollY > 50);
  document.querySelectorAll('.animate-on-scroll').forEach(el => {
    const rect = el.getBoundingClientRect();
    if (rect.top < window.innerHeight - 100) el.classList.add('visible');
  });
}
window.addEventListener('scroll', handleScroll);

// Close profile card / emoji picker on outside click
document.addEventListener('click', (e) => {
  const profileCard = document.getElementById('profile-card');
  if (state.profileCardOpen && !profileCard.contains(e.target) && !e.target.closest('.msg-avatar') && !e.target.closest('.member-item') && !e.target.closest('.user-panel-avatar')) {
    profileCard.classList.remove('open');
    state.profileCardOpen = false;
  }
  if (state.emojiPickerOpen && !e.target.closest('.emoji-picker') && !e.target.closest('.emoji-trigger')) {
    state.emojiPickerOpen = false;
    document.getElementById('emoji-picker').classList.remove('open');
  }
});

// Close modals on overlay click
document.querySelectorAll('.modal-overlay').forEach(overlay => {
  overlay.addEventListener('click', (e) => {
    if (e.target === overlay) overlay.classList.remove('open');
  });
});

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
    e.preventDefault();
    openSearch();
  }
  if (e.key === 'Escape') {
    document.querySelectorAll('.modal-overlay.open').forEach(m => m.classList.remove('open'));
    document.getElementById('profile-card').classList.remove('open');
    state.profileCardOpen = false;
    if (state.emojiPickerOpen) {
      state.emojiPickerOpen = false;
      document.getElementById('emoji-picker').classList.remove('open');
    }
  }
});

// Emoji tab switching
document.querySelectorAll('.emoji-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.emoji-tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    renderEmojiGrid(tab.dataset.cat);
  });
});

// ========== Section 5: Simulated Features ==========
const typingUsers = ['Sarah','Marcus','Alex','Emma','DJ_Nova'];
let typingInterval;

function simulateTyping() {
  const indicator = document.getElementById('typing-indicator');
  const user = typingUsers[Math.floor(Math.random() * typingUsers.length)];
  indicator.innerHTML = `<div class="typing-dots"><span></span><span></span><span></span></div> <strong>${user}</strong> is typing...`;
  setTimeout(() => { indicator.innerHTML = ''; }, 3000 + Math.random() * 3000);
}

function simulateIncoming() {
  const msgs = DATA.messages[state.activeChannel];
  if (!msgs) return;
  const incoming = [
    { user: 'sarah', text: 'Anyone want to try the new game mode? It just dropped!' },
    { user: 'marcus', text: 'I heard it\'s really good. Let me finish this match first.' },
    { user: 'alex', text: 'Just watched a tutorial on it. Looks like so much fun üéÆ' },
    { user: 'emma', text: 'Taking a break from studying. Count me in!' },
    { user: 'nova', text: 'I just dropped a beat that syncs perfectly with the game\'s soundtrack üéµ' },
    { user: 'jordan', text: 'Back from AFK! What did I miss?' },
    { user: 'codewitch', text: 'Interesting approach. Have you tried using a hashmap instead?' },
    { user: 'pixel', text: 'Just finished another pixel art piece. Posting in showcase soon!' },
    { user: 'riley', text: 'Going live in 10 minutes! Come hang out üî¥' },
    { user: 'beatsmith', text: 'This lo-fi beat is hitting different at 2am üåô' }
  ];
  const msg = incoming[Math.floor(Math.random() * incoming.length)];
  msgs.push({
    id: msgs.length + 1,
    user: msg.user,
    text: msg.text,
    time: 'Just now',
    reactions: []
  });
  renderMessages();
}

// ========== Section 6: Init ==========
function renderAll() {
  renderServerBar();
  renderChannels();
  renderMessages();
  renderMembers();
  renderEmojiGrid('smileys');
  document.getElementById('member-toggle-btn').classList.add('active');
}

// Start simulated features when app is open
function startSimulation() {
  setInterval(() => {
    if (document.body.classList.contains('in-app')) {
      if (Math.random() < 0.3) simulateTyping();
    }
  }, 8000);
  setInterval(() => {
    if (document.body.classList.contains('in-app')) {
      simulateIncoming();
    }
  }, 30000);
}

// Init
handleScroll();
startSimulation();
</script>
</body>
</html>
